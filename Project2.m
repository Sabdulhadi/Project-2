%project 2
%Internal wing structure 
clear all;
close all;
clc;

%% Input data 

% Nodal coordinates
x = [
  15.90000000,   1.85347500,  -1.26306070
  16.37993300,   2.74947500,  -1.15390270
  16.72863500,   3.40047500,  -1.07459260
  17.04466200,   3.99047500,  -1.00271410
  18.69000000,   1.85347500,  -1.26306070
  17.34997700,   4.56047500,  -0.93327205
  19.01494100,   2.74947500,  -1.15390270
  19.25103100,   3.40047500,  -1.07459260
  17.64404300,   5.10947500,  -0.86638842
  19.46499900,   3.99047500,  -1.00271410
  18.01470600,   5.80147500,  -0.78208338
  19.67171300,   4.56047500,  -0.93327205
  18.20003700,   6.14747500,  -0.73993086
  19.87081200,   5.10947500,  -0.86638842
  18.60033300,   6.89479850,  -0.64888586
  20.12177100,   5.80147500,  -0.78208338
  20.24725100,   6.14747500,  -0.73993086
  20.31191500,   6.32578240,  -0.71820801
  18.92707400,   7.50479850,  -0.57457073
  20.54448900,   6.96708800,  -0.64007898
  19.25435000,   8.11579850,  -0.50013376
  20.77744500,   7.60944480,  -0.56182186
  19.58162500,   8.72679850,  -0.42569679
  21.01040000,   8.25180170,  -0.48356475
  19.89765300,   9.31679850,  -0.35381822
  21.23534900,   8.87208090,  -0.40799732
  20.15904500,   9.80479850,  -0.29436611
  21.42140800,   9.38512530,  -0.34549409
  20.42097300,  10.29379900,  -0.23479217
  21.60784900,   9.89922110,  -0.28286279
  20.68236500,  10.78179900,  -0.17534006
  21.79390800,  10.41226600,  -0.22035956
  20.93304500,  11.24979900,  -0.11832451
  21.97234200,  10.90428400,  -0.16041794
  21.20568500,  11.75879900,  -0.05631401
  22.16640800,  11.43940600,  -0.09522502
  21.45636500,  12.22679900,   0.00070154
  22.34484200,  11.93142400,  -0.03528340
  21.77239200,  12.81679900,   0.07258011
  22.56979100,  12.55170300,   0.04028402
  22.02360700,  13.28579900,   0.12971749
  22.74860600,  13.04477200,   0.10035372
  22.27439000,  13.75399200,   0.18675664
  22.92711400,  13.53699400,   0.16032015
  22.57906600,  14.32279900,   0.25605322
  23.14398200,  14.13499200,   0.23317308
  22.89562900,  14.91379900,   0.32805363
  23.36931200,  14.75632200,   0.30886859
  23.22236900,  15.52379900,   0.40236876
  23.60188600,  15.39762800,   0.38699762
  23.56329800,  16.16028900,   0.47991118
  23.84456000,  16.06678300,   0.46851956
  23.85800000,  16.71047500,   0.54693930
  24.07800000,  16.71047500,   0.54693930
];

% Nodal connectivities
%  Ribs: rows 1 to 27
%  Front spar: rows 28 to 53
%  Rear spar: rows 54 to 79
Tnod = [
              1              5
              2              7
              3              8
              4             10
              6             12
              9             14
             11             16
             13             17
             15             18
             19             20
             21             22
             23             24
             25             26
             27             28
             29             30
             31             32
             33             34
             35             36
             37             38
             39             40
             41             42
             43             44
             45             46
             47             48
             49             50
             51             52
             53             54 % rib 27
              1              2 % spar 28
              2              3
              3              4
              4              6
              6              9
              9             11
             11             13
             13             15
             15             19
             19             21
             21             23
             23             25
             25             27
             27             29
             29             31
             31             33
             33             35
             35             37
             37             39
             39             41
             41             43
             43             45
             45             47
             47             49
             49             51
             51             53 % front spar 53
              5              7 %rear spar54
              7              8
              8             10
             10             12
             12             14
             14             16
             16             17
             17             18
             18             20
             20             22
             22             24
             24             26
             26             28
             28             30
             30             32
             32             34
             34             36
             36             38
             38             40
             40             42
             42             44
             44             46
             46             48
             48             50
             50             52
             52             54
];

% Material connectivities
%  Ribs: rows 1 to 27
%  Front spar: rows 28 to 53
%  Rear spar: rows 54 to 79
Tmat = [
              2 %Ribs 1
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2
              2 % rib 27
              1 % front spar 28
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % front spar
              1 % rear spar 54
              1 % rear spar 55 
              1% rear spar 56
              1% rear spar 57 
              1% rear spar 58
              1% rear spar 59
              1% rear spar 60 
              1% rear spar 61
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar
              1% rear spar 79
];

% Geometrical parameters
%  I-section height: dat(:,1)
%  alpha angle:      dat(:,2)
%  beta angle:       dat(:,3)
%  gamma angle:      dat(:,4)
dat = [
   1.03000,   0.00000,   0.00000,   0.00000
   0.97391,   0.00000,   0.00000,   0.00000
   0.93316,   0.00000,   0.00000,   0.00000
   0.89623,   0.00000,   0.00000,   0.00000
   0.86055,   0.00000,   0.00000,   0.00000
   0.82618,   0.00000,   0.00000,   0.00000
   0.78287,   0.00000,   0.00000,   0.00000
   0.76121,   0.00000,   0.00000,   0.00000
   0.73224,   0.00000,  -0.03841,  -0.32096
   0.69307,   0.00000,  -0.03841,  -0.32096
   0.65385,   0.00000,  -0.03841,  -0.32096
   0.61462,   0.00000,  -0.03841,  -0.32096
   0.57674,   0.00000,  -0.03841,  -0.32096
   0.54541,   0.00000,  -0.03841,  -0.32096
   0.51401,   0.00000,  -0.03841,  -0.32096
   0.48268,   0.00000,  -0.03841,  -0.32096
   0.45263,   0.00000,  -0.03841,  -0.32096
   0.41996,   0.00000,  -0.03841,  -0.32096
   0.38991,   0.00000,  -0.03841,  -0.32096
   0.35203,   0.00000,  -0.03841,  -0.32096
   0.32192,   0.00000,  -0.03841,  -0.32096
   0.29186,   0.00000,  -0.03841,  -0.32096
   0.25534,   0.00000,  -0.03841,  -0.32096
   0.21739,   0.00000,  -0.03841,  -0.32096
   0.17823,   0.00000,  -0.03841,  -0.32096
   0.13737,   0.00000,  -0.03841,  -0.32096
   0.10000,   0.00000,   0.00000,   0.00000
   1.00196,   0.00000,   0.10698,   1.07905
   0.95354,   0.00000,   0.10698,   1.07904
   0.91470,   0.00000,   0.10698,   1.07905
   0.87839,   0.00000,   0.10698,   1.07904
   0.84337,   0.00000,   0.10698,   1.07905
   0.80453,   0.00000,   0.10698,   1.07904
   0.77204,   0.00000,   0.10698,   1.07905
   0.73782,   0.00000,   0.10698,   1.07905
   0.69534,   0.00000,   0.10698,   1.07904
   0.65712,   0.00000,   0.10698,   1.07904
   0.61888,   0.00000,   0.10698,   1.07905
   0.58129,   0.00000,   0.10698,   1.07904
   0.54755,   0.00000,   0.10698,   1.07905
   0.51697,   0.00000,   0.10698,   1.07905
   0.48639,   0.00000,   0.10698,   1.07905
   0.45647,   0.00000,   0.10698,   1.07904
   0.42589,   0.00000,   0.10698,   1.07905
   0.39531,   0.00000,   0.10698,   1.07904
   0.36220,   0.00000,   0.10698,   1.07905
   0.32905,   0.00000,   0.10698,   1.07905
   0.29972,   0.00000,   0.10698,   1.07904
   0.26726,   0.00000,   0.10698,   1.07904
   0.23096,   0.00000,   0.10698,   1.07905
   0.19337,   0.00000,   0.10698,   1.07905
   0.15436,   0.00000,   0.10698,   1.07905
   0.11722,   0.00000,   0.10698,   1.07904
   1.00196,   0.00000,   0.11403,   1.22289
   0.95354,   0.00000,   0.11403,   1.22289
   0.91470,   0.00000,   0.11403,   1.22289
   0.87839,   0.00000,   0.11403,   1.22289
   0.84337,   0.00000,   0.11403,   1.22289
   0.80453,   0.00000,   0.11403,   1.22289
   0.77204,   0.00000,   0.11403,   1.22289
   0.75563,   0.00000,   0.11403,   1.22289
   0.72998,   0.00000,   0.11403,   1.22289
   0.68980,   0.00000,   0.11403,   1.22289
   0.64959,   0.00000,   0.11403,   1.22289
   0.61007,   0.00000,   0.11403,   1.22289
   0.57460,   0.00000,   0.11403,   1.22289
   0.54245,   0.00000,   0.11403,   1.22289
   0.51030,   0.00000,   0.11403,   1.22289
   0.47885,   0.00000,   0.11403,   1.22289
   0.44670,   0.00000,   0.11403,   1.22289
   0.41455,   0.00000,   0.11403,   1.22289
   0.37974,   0.00000,   0.11403,   1.22289
   0.34489,   0.00000,   0.11403,   1.22289
   0.31406,   0.00000,   0.11403,   1.22289
   0.27993,   0.00000,   0.11403,   1.22289
   0.24177,   0.00000,   0.11403,   1.22289
   0.20225,   0.00000,   0.11403,   1.22289
   0.16124,   0.00000,   0.11403,   1.22289
   0.12015,   0.00000,   0.11403,   1.22289
];

A=zeros(79,1);
Es=zeros(79,1);
Er=zeros(79,1);
Dr=zeros(79,1);
Ds=zeros(79,1);
%defining conditions to the elements 
%Spar        
Gs=2.5e10; %Pa
as=0.01; %(m)
bs=0.1;%(m) 
ts=0.005;
%ribs
Gr=3.0e10; %pa
ar=0.005; %m
br=0.015; %m
tr=0.002; %m


for e=1:79
    if Tmat(e)==1 %spar
        A(e)= (50-ts)*as+2*bs*ts; %area
        Es(e) =7e10; %Young modulus Pa
        Ds(e)= 2300; %density  kg/m^3
         elseif Tmat(e)==2 % ribs
        A(e)= (7.5-ts)*as+2*bs*ts; %area
        Er(e) = 6e10; %young modulus Pa
        Dr(e) = 2000; %density kg/m^3
        
    end
end

%defining the Inertia of element 
Iy=zeros(79,1);
Iz=zeros(79,1);
J=zeros(79,1);
for e=1:79
    if Tmat(e)==1 %spar
        Iy(e)= 1/12*as*((dat(e,1))-ts)^3+1/6*bs*ts^3+bs*ts*(dat(e,1)^2/2);
        Iz(e)=1/12*((dat(e,1))-ts)*as^3+1/6*ts*bs^3;
        J(e)=1/3*(2*bs*ts^3+(dat(e,1))*as^3);
    elseif Tmat(e)==2 %Ribs
        Iy(e)= 1/12*ar*(dat(e,1)-tr)^3+1/6*br*tr^3+br*tr*(dat(e,1)^2/2);
        Iz(e)=1/12*(dat(e,1)-tr)*ar^3+1/6*tr*br^3;
        J(e)=1/3*(2*br*tr^3+7.5*ar^3);
    end
end
%lift 
ly=zeros(79,1);
ly1=zeros(79,1);
for e=28:53
    ly(e)=(Tnod(e,1)); %front spar
    for i=54:79
         ly1(i)=(Tnod(e,1)); %rear spar
    end
end

lf1 = 15; % kN/m Front spar
lf2 = 5; % kN/m Front spar
df1 = 1; % kN/m Front spar

lr1= 4.5; % kN/m Rear  spar
lr2 = 4.5; % kN/m rear spar
%l(e)= x(Tnod(e,1),1);
l=zeros(53,1); %lift 
for e=1:79
    l(e)=(0.5*(lf1+lf2+(lf1-lf2)*cos(pi*(ly))));
 end

